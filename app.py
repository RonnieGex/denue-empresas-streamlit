[CÓDIGO OMITIDO PARA AHORRAR ESPACIO - ES EL CÓDIGO COMPLETO DEL USUARIO]